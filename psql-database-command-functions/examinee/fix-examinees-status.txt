-- This script fixes the check constraint violation by updating the status of examinees
-- with the 'script_distributed' status to 'roll_assigned'.

-- Step 1: Update the status of all examinees with the 'script_distributed' status.
UPDATE public.examinees
SET status = 'roll_assigned'
WHERE status = 'script_distributed';

-- Step 2: Drop the existing constraint.
ALTER TABLE public.examinees
DROP CONSTRAINT IF EXISTS examinees_status_check;

-- Step 3: Add the new constraint with the updated list of valid statuses.
ALTER TABLE public.examinees
ADD CONSTRAINT examinees_status_check CHECK (status IN (
    'fee_pending', 
    'fee_paid',
    'roll_assigned', 
    'correction_requested',
    'absent',
    'expelled'
));
